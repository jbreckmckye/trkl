(function(f,d){"function"===typeof define&&define.amd?define("trkl",[],d):f.trkl=d()})(this,function(){function f(l){function h(a){-1===e.indexOf(a)&&e.push(a)}function k(a){var b=g;g=a;b!==a&&e.forEach(function(a){a(g,b)})}var g=l,e=[],c=function(a){if(0<arguments.length)k(a);else{var b=d[d.length-1];b&&h(b.subscriber);return g}};c.subscribe=h;c.unsubscribe=function(a){var b=e;a=b.indexOf(a);-1!==a&&b.splice(a,1)};c.map=function(a){return f.computed(function(){return a(c())})};c.scan=function(a,
b){var c=f(b);h(function(b){b=a(c(),b);c(b)});return c};return c}var d=[];f.computed=function(l){function h(){if(-1!==d.indexOf(g))throw Error("Circular computation detected");d.push(g);var e,c;try{c=l()}catch(a){e=a}d.pop();if(e)throw e;k(c)}var k=f(),g={subscriber:h};h();return k};return f});

(function(e,c){"function"===typeof define&&define.amd?define("trkl",[],c):e.trkl=c()})(this,function(){function e(h){function g(b){var a=d;d=b;a!==b&&f.forEach(function(b){b(d,a)})}var d=h,f=[],a=function(b){if(0<arguments.length)g(b);else{var k=c[c.length-1];k&&a.subscribe(k.subscriber);return d}};a.subscribe=function(b){-1===f.indexOf(b)&&f.push(b)};a.unsubscribe=function(b){var a=f;b=a.indexOf(b);-1!==b&&a.splice(b,1)};a.map=function(b){return e.computed(function(){return b(a())})};a.scan=function(b,
c){var d=e();a.subscribe(function(a){a=b(c,a);d(a)});return d};return a}var c=[];e.computed=function(h){function g(){if(-1!==c.indexOf(f))throw Error("Circular computation detected");c.push(f);var a,b;try{b=h()}catch(e){a=e}c.pop();if(a)throw a;d(b)}var d=e(),f={subscriber:g};g();return d};return e});